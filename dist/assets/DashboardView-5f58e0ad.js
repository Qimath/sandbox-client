import{_ as S,u as I,a as D,c,o as _,b as $,d as l,e as t,f as r,B as x,w,g as k,h as P,i as A,l as U,p as Y,j as N,r as z,k as W,m as C,n as Z,q,s as G,t as H,v as B,T as E,x as K,y as L,z as M,A as j,K as R,C as F,D as J}from"./index-3c1522e6.js";const T=d=>(Y("data-v-02ae8559"),d=d(),N(),d),Q={class:"element"},X={class:"form"},ee={class:"auth-container"},oe=T(()=>l("h3",null,"Account Overview",-1)),re=T(()=>l("div",{class:"or-separator"},[l("span",null,"or")],-1)),ae={__name:"ProfileOverview",emits:["auth-window","banner"],setup(d,{emit:m}){const n=I(),i=D(),p=c(()=>n.getAccount().nickname),h=c(()=>n.getAccount().email),b=c(()=>n.getAccount().avatar),f=c(()=>n.getAccount().login);async function v(){try{const u=await U();u.error&&u.error!==""?m("banner",{message:u.error,type:"error",animate:!0}):(window.sessionStorage.setItem("loggedOut","true"),i.push({name:"account"}).then(()=>i.go()))}catch(u){console.error("An app error occurred:",u)}}function e(){i.push("/settings")}return(u,o)=>(_(),$("div",Q,[l("div",X,[l("div",ee,[oe,t(x,{primary:r(p),secondary:r(h),picture:r(b),status:r(f)},null,8,["primary","secondary","picture","status"]),t(A,{id:"go-settings",color:"blue",button:"",onClick:P(e,["prevent"])},{button:w(()=>[k("settings")]),_:1},8,["onClick"]),t(A,{id:"logout",color:"orange",button:"",onClick:P(v,["prevent"])},{button:w(()=>[k("logout")]),_:1},8,["onClick"]),re,t(A,{id:"go-edit",color:"default",button:"",onClick:o[0]||(o[0]=P(a=>u.$emit("auth-window","edit"),["prevent"]))},{button:w(()=>[k("edit profile")]),_:1})])])]))}},se=S(ae,[["__scopeId","data-v-02ae8559"]]);const V=d=>(Y("data-v-9a06140a"),d=d(),N(),d),te={class:"element"},ne={class:"form"},ie={class:"auth-container"},ue=V(()=>l("h3",null,"Account Information",-1)),ce=["onSubmit"],le=V(()=>l("div",{class:"or-separator"},[l("span",null,"or")],-1)),de={__name:"ProfileEdition",emits:["auth-window","banner"],setup(d,{emit:m}){const n=I(),i=c(()=>n.getAccount().nickname),p=c(()=>n.getAccount().email),h=c(()=>n.getAccount().avatar),b=c(()=>n.getAccount().login),f=c(()=>n.getAccount().provider),v=f.value==="email",e=z({email:{value:p.value,error:""},password:{value:"",error:""},confirmPassword:{value:"",error:""}});W(()=>[e.email.value,e.password.value,e.confirmPassword.value],([o,a,s],[y,g,O])=>{o!==y&&e.email.error&&(e.email.error=""),a!==g&&e.password.error&&(e.password.error=""),s!==O&&e.confirmPassword.error&&(e.confirmPassword.error="")});async function u(){e.result=null,e.email.error="",e.password.error="",e.confirmPassword.error="";const o=e.password.value,a=e.confirmPassword.value,s=e.email.value;if(!v){switch(f.value){case"google":m("banner",{message:"Your account profile cannot be edited here. You can updated your information from your <strong>Google</strong> account.",type:"error",animate:!0});break;case"github":m("banner",{message:"Your account profile cannot be edited here. You can updated your information from your <strong>Github</strong> account.",type:"error",animate:!0});break;default:m("banner",{message:"You do not have permission to edit your account information here. Check with your provider.",type:"error",animate:!0})}return}let y=!1;if(s&&(!/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(s)||s.length>64)&&(setTimeout(()=>{e.email.error="Email address invalid"},1),y=!0),o&&((o.length<8||o.length>64)&&(setTimeout(()=>{e.password.error="Invalid password length"},1),y=!0),(a!==o||a==="")&&(setTimeout(()=>{e.confirmPassword.error="Passwords do not match"},1),y=!0)),!y){if(s===p.value){m("banner",{message:"Your modifications were saved. Nothing was changed at all, congratulations!",type:"warning",animate:!0});return}try{const g=await Z(s,o);g.error&&g.error!==""?m("banner",{message:g.error,type:"error",animate:!0}):m("banner",{message:"Your modifications have been saved. If you requested to change your email address, a confirmation link has been sent.",type:"info",animate:!0})}catch(g){console.error("An app error occurred:",g)}}}return(o,a)=>(_(),$("div",te,[l("div",ne,[l("div",ie,[ue,t(x,{primary:r(i),secondary:r(p),picture:r(h),status:r(b)},null,8,["primary","secondary","picture","status"]),l("form",{onSubmit:P(u,["prevent"])},[t(C,{id:"user-email",label:"Email address",error:e.email.error,success:e.email.success,icon:"email",value:e.email.value,"onUpdate:value":a[0]||(a[0]=s=>e.email.value=s),disabled:!r(v)},null,8,["error","success","value","disabled"]),t(C,{id:"user-password",label:"Password",error:e.password.error,success:e.password.success,icon:"lock",value:e.password.value,"onUpdate:value":a[1]||(a[1]=s=>e.password.value=s),type:"password",disabled:!r(v)},null,8,["error","success","value","disabled"]),t(C,{id:"user-password-confirm",label:"Confirm password",error:e.confirmPassword.error,success:e.confirmPassword.success,icon:"lock",value:e.confirmPassword.value,"onUpdate:value":a[2]||(a[2]=s=>e.confirmPassword.value=s),type:"password",disabled:!r(v)},null,8,["error","success","value","disabled"]),t(A,{id:"profile-submit",color:"blue",value:"update & save"})],40,ce),le,t(A,{id:"go-overview",color:"default",button:"",onClick:a[3]||(a[3]=P(s=>o.$emit("auth-window","overview"),["prevent"]))},{button:w(()=>[k("profile overview")]),_:1})])])]))}},me=S(de,[["__scopeId","data-v-9a06140a"]]);const pe={class:"view-wrapper"},ve={__name:"DashboardView",setup(d){const m=I(),n=c(()=>m.getAccount().email),{bannerOptions:i,displayBanner:p,closeBanner:h}=L(),b=q("overview");function f(o){b.value=o}const v=c(()=>{switch(b.value){case"overview":return se;case"edit":return me;default:return LoginHandler}});function e(o){p(o)}function u(o){o==="login"&&(f(o),h())}return G(()=>{window.sessionStorage.getItem("loggedIn")&&(p({message:`You are now successfully logged in as <strong>${n.value}</strong>`,type:"success",animate:!0}),window.sessionStorage.removeItem("loggedIn")),window.sessionStorage.getItem("emailChanged")&&(p({message:`Your email address has been successfully updated to <strong>${n.value}</strong>`,type:"success",animate:!0}),window.sessionStorage.removeItem("emailChanged"))}),(o,a)=>(_(),$("div",pe,[t(H,{full:"",grow:""},{container:w(()=>[t(M,null,{card:w(()=>[t(E,{name:"slide-fade",mode:"out-in"},{default:w(()=>[(_(),B(R,null,[(_(),B(j(r(v)),{key:r(v),onAuthWindow:f,onBanner:e},null,32))],1024))]),_:1})]),_:1})]),_:1}),(_(),B(K,{to:"body"},[t(E,{name:"banner",mode:"out-in"},{default:w(()=>[r(i).visibility?(_(),B(F,{key:0,onBannerClose:r(h),onBannerAction:u,message:r(i).message,action:r(i).action,animate:r(i).animate,type:r(i).type},null,8,["onBannerClose","message","action","animate","type"])):J("",!0)]),_:1})]))]))}},fe=S(ve,[["__scopeId","data-v-b6a95aa2"]]);export{fe as default};
