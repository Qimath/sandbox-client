import{_ as C,E as k,u as H,n as d,r as N,w as U,F as z,o as h,c as x,a as m,b as t,g as r,G as D,f as B,B as P,d as S,e as _,H as A,I as Y,J as Z,p as J,j as M,q as O,t as j,v as I,T as q,x as F,y as G,z as L,C as R,D as W}from"./index-ee3591da.js";const E=p=>(J("data-v-7f482f0c"),p=p(),M(),p),K={class:"element"},Q={class:"form"},X={class:"auth-container"},ee=E(()=>m("h3",null,"Account Profile",-1)),se=["onSubmit"],re=E(()=>m("div",{class:"or-separator"},[m("span",null,"or")],-1)),oe={__name:"ProfileHandler",emits:["banner"],setup(p,{emit:f}){const n=k(),i=H(),v=d(()=>n.getAccount().nickname),w=d(()=>n.getAccount().email),b=d(()=>n.getAccount().avatar),y=d(()=>n.getAccount().login),g=d(()=>n.getAccount().provider).value==="email",e=N({email:{value:w.value,error:""},password:{value:"",error:""},confirmPassword:{value:"",error:""}});U(()=>[e.email.value,e.password.value,e.confirmPassword.value],([s,a,l],[o,u,$])=>{s!==o&&e.email.error&&(e.email.error=""),a!==u&&e.password.error&&(e.password.error=""),l!==$&&e.confirmPassword.error&&(e.confirmPassword.error="")});async function T(){try{const s=await Y();s.error&&s.error!==""?f("banner",{message:s.error,type:"error",animate:!0}):(window.sessionStorage.setItem("loggedOut","true"),i.push({name:"account"}).then(()=>i.go()))}catch(s){console.error("An app error occurred:",s)}}async function V(){e.result=null,e.email.error="",e.password.error="",e.confirmPassword.error="";const s=e.password.value,a=e.confirmPassword.value,l=e.email.value;let o=!1;if(l&&(!/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(l)||l.length>64)&&(setTimeout(()=>{e.email.error="Email address invalid"},1),o=!0),s&&((s.length<8||s.length>64)&&(setTimeout(()=>{e.password.error="Invalid password length"},1),o=!0),(a!==s||a==="")&&(setTimeout(()=>{e.confirmPassword.error="Passwords do not match"},1),o=!0)),!o)try{const u=await Z(l,s);console.log(u),u.error&&u.error!==""?f("banner",{message:u.error,type:"error",animate:!0}):f("banner",{message:"Your profile has been successfully updated!",type:"success",animate:!0})}catch(u){console.error("An app error occurred:",u)}}return(s,a)=>{const l=z("router-link");return h(),x("div",K,[m("div",Q,[m("div",X,[ee,t(D,{primary:r(v),secondary:r(w),picture:r(b),status:r(y)},null,8,["primary","secondary","picture","status"]),m("form",{onSubmit:B(V,["prevent"])},[t(P,{id:"user-email",label:"Email address",error:e.email.error,success:e.email.success,icon:"email",value:e.email.value,"onUpdate:value":a[0]||(a[0]=o=>e.email.value=o),disabled:!r(g)},null,8,["error","success","value","disabled"]),t(P,{id:"user-password",label:"Password",error:e.password.error,success:e.password.success,icon:"lock",value:e.password.value,"onUpdate:value":a[1]||(a[1]=o=>e.password.value=o),type:"password",disabled:!r(g)},null,8,["error","success","value","disabled"]),t(P,{id:"user-password-confirm",label:"Confirm password",error:e.confirmPassword.error,success:e.confirmPassword.success,icon:"lock",value:e.confirmPassword.value,"onUpdate:value":a[2]||(a[2]=o=>e.confirmPassword.value=o),type:"password",disabled:!r(g)},null,8,["error","success","value","disabled"]),t(S,{id:"profile-submit",color:"blue",value:"update & save"})],40,se),re,t(S,{id:"logout",color:"orange",button:"",onClick:B(T,["prevent"])},{button:_(()=>[A("logout")]),_:1},8,["onClick"]),t(l,{to:"/settings",class:"auth-option go-settings"},{default:_(()=>[A("Just take me to the Settings page")]),_:1})])])])}}},ae=C(oe,[["__scopeId","data-v-7f482f0c"]]);const te={class:"view-wrapper"},ne={__name:"DashboardView",setup(p){const f=k(),n=d(()=>f.getAccount().email),{bannerOptions:i,displayBanner:v,closeBanner:w}=G();function b(c){v(c)}function y(c){c==="login"&&(authWindowSwap(c),w())}return O(()=>{window.sessionStorage.getItem("loggedIn")&&(v({message:`You are now successfully logged in as <strong>${n.value}</strong>`,type:"success",animate:!0}),window.sessionStorage.removeItem("loggedIn")),window.sessionStorage.getItem("emailChanged")&&(v({message:`Your email address has been successfully updated to <strong>${n.value}</strong>`,type:"success",animate:!0}),window.sessionStorage.removeItem("emailChanged"))}),(c,g)=>(h(),x("div",te,[t(j,{full:"",grow:""},{container:_(()=>[t(L,null,{card:_(()=>[t(ae,{onBanner:b})]),_:1})]),_:1}),(h(),I(F,{to:"body"},[t(q,{name:"banner",mode:"out-in"},{default:_(()=>[r(i).visibility?(h(),I(R,{key:0,onBannerClose:r(w),onBannerAction:y,message:r(i).message,action:r(i).action,animate:r(i).animate,type:r(i).type},null,8,["onBannerClose","message","action","animate","type"])):W("",!0)]),_:1})]))]))}},le=C(ne,[["__scopeId","data-v-ee52a240"]]);export{le as default};
