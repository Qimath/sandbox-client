import{_ as $,u as k,a as U,c as l,o as w,b as I,d as c,e as a,f as r,B as x,w as v,g as C,h as P,i as A,l as z,p as O,j as T,r as W,k as Y,m as S,n as Z,q as H,s as K,t as L,v as B,T as E,x as M,y as j,z as q,A as R,K as F,C as G,D as J}from"./index-b74e82fd.js";const V=d=>(O("data-v-02ae8559"),d=d(),T(),d),Q={class:"element"},X={class:"form"},ee={class:"auth-container"},se=V(()=>c("h3",null,"Account Overview",-1)),re=V(()=>c("div",{class:"or-separator"},[c("span",null,"or")],-1)),oe={__name:"ProfileOverview",emits:["auth-window","banner"],setup(d,{emit:f}){const t=k(),i=U(),m=l(()=>t.getAccount().nickname),g=l(()=>t.getAccount().email),h=l(()=>t.getAccount().avatar),y=l(()=>t.getAccount().login);async function p(){try{const u=await z();u.error&&u.error!==""?f("banner",{message:u.error,type:"error",animate:!0}):(window.sessionStorage.setItem("loggedOut","true"),i.push({name:"account"}).then(()=>i.go()))}catch(u){console.error("An app error occurred:",u)}}function e(){i.push("/settings")}return(u,s)=>(w(),I("div",Q,[c("div",X,[c("div",ee,[se,a(x,{primary:r(m),secondary:r(g),picture:r(h),status:r(y)},null,8,["primary","secondary","picture","status"]),a(A,{id:"go-settings",color:"blue",button:"",onClick:P(e,["prevent"])},{button:v(()=>[C("settings")]),_:1},8,["onClick"]),a(A,{id:"logout",color:"orange",button:"",onClick:P(p,["prevent"])},{button:v(()=>[C("logout")]),_:1},8,["onClick"]),re,a(A,{id:"go-edit",color:"default",button:"",onClick:s[0]||(s[0]=P(o=>u.$emit("auth-window","edit"),["prevent"]))},{button:v(()=>[C("edit profile")]),_:1})])])]))}},ae=$(oe,[["__scopeId","data-v-02ae8559"]]);const N=d=>(O("data-v-9f898d06"),d=d(),T(),d),te={class:"element"},ne={class:"form"},ie={class:"auth-container"},ue=N(()=>c("h3",null,"Account Overview",-1)),le=["onSubmit"],ce=N(()=>c("div",{class:"or-separator"},[c("span",null,"or")],-1)),de={__name:"ProfileEdition",emits:["auth-window","banner"],setup(d,{emit:f}){const t=k(),i=l(()=>t.getAccount().nickname),m=l(()=>t.getAccount().email),g=l(()=>t.getAccount().avatar),h=l(()=>t.getAccount().login),p=l(()=>t.getAccount().provider).value==="email",e=W({email:{value:m.value,error:""},password:{value:"",error:""},confirmPassword:{value:"",error:""}});Y(()=>[e.email.value,e.password.value,e.confirmPassword.value],([s,o,n],[b,_,D])=>{s!==b&&e.email.error&&(e.email.error=""),o!==_&&e.password.error&&(e.password.error=""),n!==D&&e.confirmPassword.error&&(e.confirmPassword.error="")});async function u(){e.result=null,e.email.error="",e.password.error="",e.confirmPassword.error="";const s=e.password.value,o=e.confirmPassword.value,n=e.email.value;let b=!1;if(n&&(!/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(n)||n.length>64)&&(setTimeout(()=>{e.email.error="Email address invalid"},1),b=!0),s&&((s.length<8||s.length>64)&&(setTimeout(()=>{e.password.error="Invalid password length"},1),b=!0),(o!==s||o==="")&&(setTimeout(()=>{e.confirmPassword.error="Passwords do not match"},1),b=!0)),!b)try{const _=await Z(n,s);_.error&&_.error!==""?f("banner",{message:_.error,type:"error",animate:!0}):f("banner",{message:"Your profile has been successfully updated!",type:"success",animate:!0})}catch(_){console.error("An app error occurred:",_)}}return(s,o)=>(w(),I("div",te,[c("div",ne,[c("div",ie,[ue,a(x,{primary:r(i),secondary:r(m),picture:r(g),status:r(h)},null,8,["primary","secondary","picture","status"]),c("form",{onSubmit:P(u,["prevent"])},[a(S,{id:"user-email",label:"Email address",error:e.email.error,success:e.email.success,icon:"email",value:e.email.value,"onUpdate:value":o[0]||(o[0]=n=>e.email.value=n),disabled:!r(p)},null,8,["error","success","value","disabled"]),a(S,{id:"user-password",label:"Password",error:e.password.error,success:e.password.success,icon:"lock",value:e.password.value,"onUpdate:value":o[1]||(o[1]=n=>e.password.value=n),type:"password",disabled:!r(p)},null,8,["error","success","value","disabled"]),a(S,{id:"user-password-confirm",label:"Confirm password",error:e.confirmPassword.error,success:e.confirmPassword.success,icon:"lock",value:e.confirmPassword.value,"onUpdate:value":o[2]||(o[2]=n=>e.confirmPassword.value=n),type:"password",disabled:!r(p)},null,8,["error","success","value","disabled"]),a(A,{id:"profile-submit",color:"blue",value:"update & save"})],40,le),ce,a(A,{id:"go-overview",color:"default",button:"",onClick:o[3]||(o[3]=P(n=>s.$emit("auth-window","overview"),["prevent"]))},{button:v(()=>[C("profile overview")]),_:1})])])]))}},me=$(de,[["__scopeId","data-v-9f898d06"]]);const pe={class:"view-wrapper"},ve={__name:"DashboardView",setup(d){const f=k(),t=l(()=>f.getAccount().email),{bannerOptions:i,displayBanner:m,closeBanner:g}=j(),h=H("overview");function y(s){h.value=s}const p=l(()=>{switch(h.value){case"overview":return ae;case"edit":return me;default:return LoginHandler}});function e(s){m(s)}function u(s){s==="login"&&(y(s),g())}return K(()=>{window.sessionStorage.getItem("loggedIn")&&(m({message:`You are now successfully logged in as <strong>${t.value}</strong>`,type:"success",animate:!0}),window.sessionStorage.removeItem("loggedIn")),window.sessionStorage.getItem("emailChanged")&&(m({message:`Your email address has been successfully updated to <strong>${t.value}</strong>`,type:"success",animate:!0}),window.sessionStorage.removeItem("emailChanged"))}),(s,o)=>(w(),I("div",pe,[a(L,{full:"",grow:""},{container:v(()=>[a(q,null,{card:v(()=>[a(E,{name:"slide-fade",mode:"out-in"},{default:v(()=>[(w(),B(F,null,[(w(),B(R(r(p)),{key:r(p),onAuthWindow:y,onBanner:e},null,32))],1024))]),_:1})]),_:1})]),_:1}),(w(),B(M,{to:"body"},[a(E,{name:"banner",mode:"out-in"},{default:v(()=>[r(i).visibility?(w(),B(G,{key:0,onBannerClose:r(g),onBannerAction:u,message:r(i).message,action:r(i).action,animate:r(i).animate,type:r(i).type},null,8,["onBannerClose","message","action","animate","type"])):J("",!0)]),_:1})]))]))}},we=$(ve,[["__scopeId","data-v-b6a95aa2"]]);export{we as default};
