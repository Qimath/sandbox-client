import{_ as k,E as C,u as N,n as d,r as U,w as $,F as z,o as b,c as x,a as p,b as t,g as s,G as D,f as B,B as P,d as A,e as v,H as S,I as Z,J,p as M,j as O,q as Y,t as j,v as I,T as q,x as F,y as G,z as L,C as R,D as W}from"./index-a5c6e533.js";const E=m=>(M("data-v-7f482f0c"),m=m(),O(),m),K={class:"element"},Q={class:"form"},X={class:"auth-container"},ee=E(()=>p("h3",null,"Account Profile",-1)),re=["onSubmit"],se=E(()=>p("div",{class:"or-separator"},[p("span",null,"or")],-1)),oe={__name:"ProfileHandler",emits:["banner"],setup(m,{emit:f}){const c=C(),n=N(),w=d(()=>c.getAccount().nickname),_=d(()=>c.getAccount().email),h=d(()=>c.getAccount().avatar),y=d(()=>c.getAccount().login),g=d(()=>c.getAccount().provider).value==="email",e=U({email:{value:_.value,error:""},password:{value:"",error:""},confirmPassword:{value:"",error:""}});$(()=>[e.email.value,e.password.value,e.confirmPassword.value],([r,a,i],[o,l,H])=>{r!==o&&e.email.error&&(e.email.error=""),a!==l&&e.password.error&&(e.password.error=""),i!==H&&e.confirmPassword.error&&(e.confirmPassword.error="")});async function T(){try{const r=await Z();r.error&&r.error!==""?f("banner",{message:r.error,type:"error",animate:!0}):(window.sessionStorage.setItem("loggedOut","true"),n.push({name:"account"}).then(()=>n.go()))}catch(r){console.error("An app error occurred:",r)}}async function V(){e.result=null,e.email.error="",e.password.error="",e.confirmPassword.error="";const r=e.password.value,a=e.confirmPassword.value,i=e.email.value;let o=!1;if(i&&(!/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(i)||i.length>64)&&(setTimeout(()=>{e.email.error="Email address invalid"},1),o=!0),r&&((r.length<8||r.length>64)&&(setTimeout(()=>{e.password.error="Invalid password length"},1),o=!0),(a!==r||a==="")&&(setTimeout(()=>{e.confirmPassword.error="Passwords do not match"},1),o=!0)),!o)try{const l=await J(i,r);console.log(l),l.error&&l.error!==""?f("banner",{message:l.error,type:"error",animate:!0}):f("banner",{message:"Your profile has been successfully updated!",type:"success",animate:!0})}catch(l){console.error("An app error occurred:",l)}}return(r,a)=>{const i=z("router-link");return b(),x("div",K,[p("div",Q,[p("div",X,[ee,t(D,{primary:s(w),secondary:s(_),picture:s(h),status:s(y)},null,8,["primary","secondary","picture","status"]),p("form",{onSubmit:B(V,["prevent"])},[t(P,{id:"user-email",label:"Email address",error:e.email.error,success:e.email.success,icon:"email",value:e.email.value,"onUpdate:value":a[0]||(a[0]=o=>e.email.value=o),disabled:!s(g)},null,8,["error","success","value","disabled"]),t(P,{id:"user-password",label:"Password",error:e.password.error,success:e.password.success,icon:"lock",value:e.password.value,"onUpdate:value":a[1]||(a[1]=o=>e.password.value=o),type:"password",disabled:!s(g)},null,8,["error","success","value","disabled"]),t(P,{id:"user-password-confirm",label:"Confirm password",error:e.confirmPassword.error,success:e.confirmPassword.success,icon:"lock",value:e.confirmPassword.value,"onUpdate:value":a[2]||(a[2]=o=>e.confirmPassword.value=o),type:"password",disabled:!s(g)},null,8,["error","success","value","disabled"]),t(A,{id:"profile-submit",color:"blue",value:"update & save"})],40,re),se,t(A,{id:"logout",color:"orange",button:"",onClick:B(T,["prevent"])},{button:v(()=>[S("logout")]),_:1},8,["onClick"]),t(i,{to:"/settings",class:"auth-option go-settings"},{default:v(()=>[S("Just take me to the Settings page")]),_:1})])])])}}},ae=k(oe,[["__scopeId","data-v-7f482f0c"]]);const te={class:"view-wrapper"},ne={__name:"DashboardView",setup(m){const f=C(),c=d(()=>f.getAccount().email),{bannerOptions:n,displayBanner:w,closeBanner:_}=G();function h(u){w(u)}function y(u){u==="login"&&(authWindowSwap(u),_())}return Y(()=>{window.sessionStorage.getItem("loggedIn")&&(w({message:`You are now successfully logged in as <strong>${c.value}</strong>`,type:"success",animate:!0}),window.sessionStorage.removeItem("loggedIn"))}),(u,g)=>(b(),x("div",te,[t(j,{full:"",grow:""},{container:v(()=>[t(L,null,{card:v(()=>[t(ae,{onBanner:h})]),_:1})]),_:1}),(b(),I(F,{to:"body"},[t(q,{name:"banner",mode:"out-in"},{default:v(()=>[s(n).visibility?(b(),I(R,{key:0,onBannerClose:s(_),onBannerAction:y,message:s(n).message,action:s(n).action,animate:s(n).animate,type:s(n).type},null,8,["onBannerClose","message","action","animate","type"])):W("",!0)]),_:1})]))]))}},le=k(ne,[["__scopeId","data-v-c8f10185"]]);export{le as default};
