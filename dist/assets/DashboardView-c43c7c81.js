import{_ as $,u as k,a as U,c,o as w,b as I,d as l,e as a,f as o,B as x,w as _,g as C,h as P,i as A,l as z,p as O,j as T,r as W,k as Y,m as S,n as Z,q as H,s as K,t as L,v as B,T as E,x as M,y as j,z as q,A as R,K as F,C as G,D as J}from"./index-f627441d.js";const V=d=>(O("data-v-bac266e1"),d=d(),T(),d),Q={class:"element"},X={class:"form"},ee={class:"auth-container"},se=V(()=>l("h3",null,"Account Overview",-1)),oe=V(()=>l("div",{class:"or-separator"},[l("span",null,"or")],-1)),re={__name:"ProfileOverview",emits:["auth-window","banner"],setup(d,{emit:f}){const t=k(),i=U(),m=c(()=>t.getAccount().nickname),g=c(()=>t.getAccount().email),b=c(()=>t.getAccount().avatar),y=c(()=>t.getAccount().login);async function p(){try{const u=await z();u.error&&u.error!==""?f("banner",{message:u.error,type:"error",animate:!0}):(window.sessionStorage.setItem("loggedOut","true"),i.push({name:"account"}).then(()=>i.go()))}catch(u){console.error("An app error occurred:",u)}}function e(){i.push("/settings")}return(u,s)=>(w(),I("div",Q,[l("div",X,[l("div",ee,[se,a(x,{primary:o(m),secondary:o(g),picture:o(b),status:o(y)},null,8,["primary","secondary","picture","status"]),a(A,{id:"go-settings",color:"blue",button:"",onClick:P(e,["prevent"])},{button:_(()=>[C("settings")]),_:1},8,["onClick"]),a(A,{id:"logout",color:"orange",button:"",onClick:P(p,["prevent"])},{button:_(()=>[C("logout")]),_:1},8,["onClick"]),oe,a(A,{id:"go-edit",color:"default",button:"",onClick:s[0]||(s[0]=P(r=>u.$emit("auth-window","edit"),["prevent"]))},{button:_(()=>[C("edit profile")]),_:1})])])]))}},ae=$(re,[["__scopeId","data-v-bac266e1"]]);const N=d=>(O("data-v-db94933b"),d=d(),T(),d),te={class:"element"},ne={class:"form"},ie={class:"auth-container"},ue=N(()=>l("h3",null,"Account Overview",-1)),ce=["onSubmit"],le=N(()=>l("div",{class:"or-separator"},[l("span",null,"or")],-1)),de={__name:"ProfileEdition",emits:["auth-window","banner"],setup(d,{emit:f}){const t=k(),i=c(()=>t.getAccount().nickname),m=c(()=>t.getAccount().email),g=c(()=>t.getAccount().avatar),b=c(()=>t.getAccount().login),p=c(()=>t.getAccount().provider).value==="email",e=W({email:{value:m.value,error:""},password:{value:"",error:""},confirmPassword:{value:"",error:""}});Y(()=>[e.email.value,e.password.value,e.confirmPassword.value],([s,r,n],[h,v,D])=>{s!==h&&e.email.error&&(e.email.error=""),r!==v&&e.password.error&&(e.password.error=""),n!==D&&e.confirmPassword.error&&(e.confirmPassword.error="")});async function u(){e.result=null,e.email.error="",e.password.error="",e.confirmPassword.error="";const s=e.password.value,r=e.confirmPassword.value,n=e.email.value;let h=!1;if(n&&(!/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(n)||n.length>64)&&(setTimeout(()=>{e.email.error="Email address invalid"},1),h=!0),s&&((s.length<8||s.length>64)&&(setTimeout(()=>{e.password.error="Invalid password length"},1),h=!0),(r!==s||r==="")&&(setTimeout(()=>{e.confirmPassword.error="Passwords do not match"},1),h=!0)),!h)try{const v=await Z(n,s);console.log(v),v.error&&v.error!==""?f("banner",{message:v.error,type:"error",animate:!0}):f("banner",{message:"Your profile has been successfully updated!",type:"success",animate:!0})}catch(v){console.error("An app error occurred:",v)}}return(s,r)=>(w(),I("div",te,[l("div",ne,[l("div",ie,[ue,a(x,{primary:o(i),secondary:o(m),picture:o(g),status:o(b)},null,8,["primary","secondary","picture","status"]),l("form",{onSubmit:P(u,["prevent"])},[a(S,{id:"user-email",label:"Email address",error:e.email.error,success:e.email.success,icon:"email",value:e.email.value,"onUpdate:value":r[0]||(r[0]=n=>e.email.value=n),disabled:!o(p)},null,8,["error","success","value","disabled"]),a(S,{id:"user-password",label:"Password",error:e.password.error,success:e.password.success,icon:"lock",value:e.password.value,"onUpdate:value":r[1]||(r[1]=n=>e.password.value=n),type:"password",disabled:!o(p)},null,8,["error","success","value","disabled"]),a(S,{id:"user-password-confirm",label:"Confirm password",error:e.confirmPassword.error,success:e.confirmPassword.success,icon:"lock",value:e.confirmPassword.value,"onUpdate:value":r[2]||(r[2]=n=>e.confirmPassword.value=n),type:"password",disabled:!o(p)},null,8,["error","success","value","disabled"]),a(A,{id:"profile-submit",color:"blue",value:"update & save"})],40,ce),le,a(A,{id:"go-overview",color:"default",button:"",onClick:r[3]||(r[3]=P(n=>s.$emit("auth-window","overview"),["prevent"]))},{button:_(()=>[C("profile overview")]),_:1})])])]))}},me=$(de,[["__scopeId","data-v-db94933b"]]);const pe={class:"view-wrapper"},ve={__name:"DashboardView",setup(d){const f=k(),t=c(()=>f.getAccount().email),{bannerOptions:i,displayBanner:m,closeBanner:g}=j(),b=H("overview");function y(s){b.value=s}const p=c(()=>{switch(b.value){case"overview":return ae;case"edit":return me;default:return LoginHandler}});function e(s){m(s)}function u(s){s==="login"&&(y(s),g())}return K(()=>{window.sessionStorage.getItem("loggedIn")&&(m({message:`You are now successfully logged in as <strong>${t.value}</strong>`,type:"success",animate:!0}),window.sessionStorage.removeItem("loggedIn")),window.sessionStorage.getItem("emailChanged")&&(m({message:`Your email address has been successfully updated to <strong>${t.value}</strong>`,type:"success",animate:!0}),window.sessionStorage.removeItem("emailChanged"))}),(s,r)=>(w(),I("div",pe,[a(L,{full:"",grow:""},{container:_(()=>[a(q,null,{card:_(()=>[a(E,{name:"slide-fade",mode:"out-in"},{default:_(()=>[(w(),B(F,null,[(w(),B(R(o(p)),{key:o(p),onAuthWindow:y,onBanner:e},null,32))],1024))]),_:1})]),_:1})]),_:1}),(w(),B(M,{to:"body"},[a(E,{name:"banner",mode:"out-in"},{default:_(()=>[o(i).visibility?(w(),B(G,{key:0,onBannerClose:o(g),onBannerAction:u,message:o(i).message,action:o(i).action,animate:o(i).animate,type:o(i).type},null,8,["onBannerClose","message","action","animate","type"])):J("",!0)]),_:1})]))]))}},we=$(ve,[["__scopeId","data-v-b6a95aa2"]]);export{we as default};
